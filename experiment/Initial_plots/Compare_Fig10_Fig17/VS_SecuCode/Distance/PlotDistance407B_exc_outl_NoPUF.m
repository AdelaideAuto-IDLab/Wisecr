clear all;
close all;
clc;

b20l = [8.7441589
9.793349
9.2923281
8.5090338
8.7922055
10.3706344
10.4802549
8.3200743
7.7667606
9.73381
7.0638739
9.2077505
8.784122
8.7091831
9.3347817
8.8051001
9.1228027
8.766952
8.2839695
17.6312904
9.7425226
9.8968413
9.2358076
9.2876062
9.5740847
8.0962196
8.0071209
8.5453309
8.7503694
9.8909102
8.859844
7.9267559
9.5906376
9.1768871
7.7508375
10.8790642
9.1345706
8.7540149
8.6133729
15.200472
20.3585041
17.0035046
9.7764118
8.3885851
9.1116411
15.4752986
7.8014866
9.5380568
8.0509052
10.3815264
10.0654136
9.8818169
9.1395497
7.8960294
8.8662437
7.782818
7.7917637
8.4903376
8.853184
9.6467122
8.7434933
8.8442757
9.7628371
8.1683613
9.5943955
8.8603904
8.3397027
8.9392537
8.4415067
9.863103
8.874463
10.1517826
13.2308728
8.309601
8.7241603
9.4743719
8.7979327
8.0393223
9.1557566
9.1518335
8.0707178
7.6097269
7.5822232
9.1015057
8.4554611
9.3773189
10.0806798
8.1693419
7.9886821
8.7161947
9.5797387
8.9447532
8.6275205
10.6123481
9.2240534
9.5278532
14.1585934
7.201174
8.4670754
8.4633126
];
b30l = [10.7837806
10.7507377
9.6653598
10.3855092
12.2885986
9.4200095
9.364621
11.6344014
11.4816715
9.4481857
8.9770701
9.5265553
10.4147574
18.0766142
12.0844063
9.4878602
10.4519066
8.7879183
9.4106865
10.2905219
10.2329123
11.5397388
7.8535175
7.842121
7.636158
9.1971514
8.8898722
9.5821389
8.3977828
8.9316921
11.0576979
8.2921058
9.8120963
10.1488582
10.1618421
10.0867088
8.0085439
15.3162495
10.6383427
8.470958
9.2944872
8.6190799
15.3522182
11.1824726
9.3526504
8.6268563
10.3671986
8.9686608
9.717755
8.1481686
7.9945431
11.2858378
8.893964
8.1660876
11.0903989
8.022497
8.563218
15.1380024
12.5227767
9.8041678
8.3215968
10.7248343
8.9019604
9.6274473
10.4643837
8.67936
7.8945483
9.9340456
7.7047971
7.4277958
10.3045294
7.583874
17.6804677
26.2427073
9.2699512
9.023544
9.2007478
8.2024259
8.3196564
9.6308219
9.9985798
8.2071966
10.734201
10.1038943
11.1073557
9.3131209
9.2079139
8.838372
9.2805215
9.4694763
8.1121539
10.8400155
9.4717569
9.5645499
9.1939045
13.3339368
11.2559743
10.1952974
10.2187505
7.7710977
];
b40l = [28.273466
47.0424284
10.3012589
10.3788447
8.9838555
9.3047924
8.8829792
14.1416173
14.087634
20.6928462
13.8744468
11.2369706
23.6005689
9.5721205
7.8674826
10.4653219
8.9370834
25.284748
11.5765161
10.5273935
15.2716909
22.9214009
16.1183336
8.4826077
11.8666462
9.8073994
9.3028445
8.076043
22.4808693
10.5852554
10.8763999
15.2888564
10.5264336
8.7398791
13.9643765
8.9038562
9.8753398
9.4528461
15.2384313
11.4159376
12.7605146
10.1299191
10.8495035
16.8416947
10.1237692
10.7591475
10.7327658
9.3781096
16.4964837
15.9233513
9.3027499
9.0380305
8.6621509
9.3204675
13.5072465
9.3017371
14.1924615
15.8178235
17.559702
10.0148001
14.4499541
9.8263414
10.1711895
10.1878399
9.574155
13.9814691
10.2414654
9.7355776
15.4190071
9.4950549
11.2668723
10.7694885
14.3811377
10.1528202
9.8987894
14.4045125
20.5793648
10.6274793
12.3908772
10.6889825
15.9944258
10.1140148
8.5568159
8.7712578
21.9979286
10.746846
9.6014533
28.8064593
10.2510388
9.7989373
12.2470896
10.1111109
15.3262405
];
b50l = [0];

s20l = [23.9635574
20.7031818
22.4968518
19.6954071
21.3423906
28.5519413
20.964559
19.3886385
19.8382107
21.2200789
23.4296623
21.6429174
20.2145803
19.9463163
21.5938047
20.9659538
19.5240515
21.1905362
21.4448553
19.4583333
22.3823709
18.7296238
24.2988155
21.7374663
22.0520804
20.0602
20.2391432
20.9857094
21.8493273
21.7931679
21.567421
21.308832
20.7809367
22.3221145
24.2878705
23.5254069
22.9697417
20.781185
20.0018883
22.1841001
19.5941932
22.8059295
20.9873265
23.3725681
23.8271592
20.8015003
20.0850932
18.8733446
23.1276519
19.6834765
19.5318192
25.6091372
21.3541996
22.7447577
19.9176927
20.7188202
20.4244147
24.2092063
21.330902
21.6064717
20.3591886
22.2943798
24.7608755
21.6566325
18.8726319
22.0007655
21.820734
22.0717424
19.9970644
20.0104816
19.6799537
21.917383
20.4556286
19.8542964
21.8400912
18.9390566
20.4289542
23.7033373
20.8000172
19.6142081
20.0765324
20.903835
19.5445463
20.8435255
23.4161831
19.9113663
21.4983185
19.5168148
22.9971495
21.6471644
20.0844459
18.9989076
20.2222974
21.2750374
20.4838467
23.3379619
20.1094658
23.4691502
22.9665775
21.4294621
];
s30l = [
    85.3135474
48.0185683
73.1399888
88.2415278
272.4277595
96.0779755
243.5875957
104.1969646
52.6152663
125.3251784
71.6610589
132.9237364
216.5332834
53.5673557
76.0511267
205.0599821
82.5364652
79.7859146
58.2114141
62.7850513
130.3347168
21.1905658
30.9834235
19.2691541
22.2000644
20.8844874
21.4546938
21.5153869
23.404601
21.5227748
22.7575347
24.6640034
21.93476
21.3397865
23.6356654
22.2247264
26.4285932
22.9813649
20.7639157
24.6794641
23.2531166
23.0773496
23.9407149
26.2697528
21.7511509
23.2681724
23.0164631
24.837788
23.1810246
24.6706188
23.7457174
23.4243116
22.3729861
29.4133665
24.6722304
22.2519777
23.4247287
23.9563251
20.8846631
21.5556663
21.6092357
25.7249158
20.7932758
21.7182261
22.6179023
23.5621697
21.8573733
21.4135279
22.6742678
21.1440376
22.0168935
20.3827844
21.0248338
18.0873051
26.9224033
20.8290386
24.6724637
22.9483632
21.3890139
22.0237531
20.7316364
22.9125228
21.7443874
24.9759185
30.9034683
23.8948426
28.2709016
22.52225
19.5920284
22.022965
21.4708999
22.3545581
23.0875823
23.5016351
21.7347775
24.521707
21.292129
23.8683257
27.8445838
22.8326794
];
s40l = [44.8538248
41.2479754
38.6199714
47.9129574
39.7850609
38.8761772
43.3307463
47.1181478
41.9332498
42.285904
36.3729286
40.7185629
38.5791121
38.1211681
37.0955021
39.8220941
47.0196441
40.3579678
38.5617956
42.3878501
35.5583267
35.3794648
37.3412385
41.9116138
45.1090035
40.5201668
38.1562437
42.7817479
48.4537147
39.5400144
37.0552446
37.8715349
35.3770511
41.2877506
46.0690238
37.3263731
40.4329721
44.0690096
60.5393061
53.0400933
54.6557617
35.2050339
46.8950247
59.0154507
47.4321016
53.1723784
41.1944747
48.5336672
44.251965
48.0173539
38.3655764
50.915326
50.1258494
49.9625043
52.1570976
67.3066795
50.4623507
46.4831377
40.7073497
44.2261327
47.2654453
38.5708596
46.1341253
41.098557
52.7557493
49.4861207
45.6876617
65.3744585
47.9003419
57.7696061
52.8271222
49.7833097
44.6909636
48.5062879
42.5856469
46.2913035
39.0632881
50.8540172
48.3788994
47.252458
44.5405595
56.7526115
49.6583231
43.05866
40.5608804
39.2947656
45.9158706
47.2840047
53.2618488
42.7753603
49.8586963
68.9388549
42.7518545
47.1536675
41.0299194
49.8177969
45.807897
56.2785771
42.0302138
40.3573847
];
s50l = [0];

c20l = [13.7691637
13.9581576
15.1660457
13.7646133
14.6546106
14.3380472
14.2620392
13.72138
14.6049565
15.3418441
13.6047099
14.3068879
13.3412872
14.7139527
14.386621
13.3806899
13.0539196
13.7677477
15.1243795
14.6624411
13.6421156
14.5471499
14.1741612
12.719785
14.9664876
13.8441466
13.366079
14.4176395
13.5307618
14.1665247
13.0311334
14.4743519
14.2572284
14.6156927
13.0610495
14.2920701
14.3131306
14.0358867
13.4670137
13.5524486
14.1834095
13.7404289
14.5485583
13.5547838
12.7967527
14.8035907
14.3018985
14.1581656
13.9768314
13.8744072
13.3387873
14.3612131
13.4834668
12.5622991
14.2130611
14.7850962
14.3031982
13.8011215
14.2254628
14.4031674
15.0586893
14.3655479
13.1605919
13.783395
13.8222066
13.3816797
13.7569694
13.7322773
14.3538984
14.4682555
13.9716718
14.7338212
14.0755532
14.0812844
14.8094064
12.7919074
13.1822418
14.5230721
12.6186596
14.8775594
14.6314455
14.6976825
13.8869537
13.9421272
13.7581173
14.2791698
15.3862785
14.3720949
13.720585
13.8855551
13.7745203
14.2548193
14.6824297
14.0998208
13.3589657
13.9350673
14.6810693
];
c30l = [13.7364867
12.8653115
13.8397171
13.1735275
12.6914291
13.4854242
13.3711042
13.0254738
12.993083
13.3498595
14.5867301
13.7903719
13.0323598
13.5806926
13.4389676
13.652185
13.8935887
13.9154552
12.5798131
13.407514
13.2918282
13.3371032
13.9633492
13.3181894
13.6621431
12.9399507
13.249321
13.2446054
13.5571705
13.7855694
12.5867581
13.5683704
14.3852864
13.4312952
13.2899428
13.9392781
13.3907356
13.7790463
13.1039597
14.1619509
12.5045698
12.7202838
14.452336
13.8587483
14.1370287
13.3061756
12.4908125
14.7509094
13.596778
13.0104315
13.0146169
12.9135957
13.9054993
13.5852901
14.6989097
13.283677
13.0848113
14.1241395
14.0450496
13.2700459
13.2918476
12.9636131
13.9878686
13.8407122
14.1819652
13.3318059
13.425988
13.9599146
13.584065
13.1484721
12.521855
12.7339003
14.605531
13.8703791
12.4852649
14.0373964
14.1618755
13.1801479
13.8171112
13.6475937
13.0327655
13.6180665
12.7133094
13.0854162
13.722302
13.1843498
14.1340478
13.5720368
13.27509
12.6552789
12.6126112
13.691016
13.1045803
12.971856
13.3467206
13.1578372
13.5472887
12.9408126
12.809356
];
c40l = [15.56348
15.7675234
13.4193862
16.0279976
15.164744
13.7770601
15.3298661
14.3850043
14.9249563
14.7494074
16.378267
14.1715381
15.4311028
15.8402221
15.3865454
14.9038184
14.1425209
15.898833
15.6943541
14.2140282
14.8547369
16.0202962
14.9490706
15.3110511
15.6801714
15.2115081
13.9382929
16.3900415
15.4687184
14.3983363
14.4202549
16.3151804
15.0613979
13.905548
15.2407759
16.032641
14.3359534
15.860404
14.8898801
14.8796075
16.7130088
16.7269384
15.8268984
14.5026035
15.4712468
14.7706417
15.8024701
15.2682146
14.4028276
14.4765874
18.2622372
15.44841
15.1405523
16.2759507
16.3484936
14.8167765
16.2633744
15.5892535
15.9156607
16.6013819
15.0978899
14.0802409
15.0233153
16.7433623
15.8859259
15.5942356
14.8940165
14.5214413
14.4710583
15.213312
16.15525
14.0598162
15.1976069
15.0271992
17.3729305
15.2081688
14.5677634
16.3301301
17.2977674
14.9861161
14.9574528
15.2122857
16.2958072
15.7980787
14.7751374
16.277441
14.5921291
15.0254939
13.9435363
15.1241393
14.3607293
15.2337546
14.6182029
15.3472574
15.5508859
];
c50l = [0];

% remove outliers
b20l = rmoutliers(b20l,'quartiles');
b30l = rmoutliers(b30l,'quartiles');
b40l = rmoutliers(b40l,'quartiles');
b50l = rmoutliers(b50l,'quartiles');
s20l = rmoutliers(s20l,'quartiles');
s30l = rmoutliers(s30l,'quartiles');
s40l = rmoutliers(s40l,'quartiles');
s50l = rmoutliers(s50l,'quartiles');
c20l = rmoutliers(c20l,'quartiles');
c30l = rmoutliers(c30l,'quartiles');
c40l = rmoutliers(c40l,'quartiles');
c50l = rmoutliers(c50l,'quartiles');

b20t = 407*8*4./b20l;
b30t = 407*8*4./b30l;
b40t = 407*8*4./b40l;
b50t = 407*8*4./b50l;

s20t = 407*8*4./s20l;
s30t = 407*8*4./s30l;
s40t = 407*8*4./s40l;
s50t = 407*8*4./s50l;

c20t = 407*8*4./c20l;
c30t = 407*8*4./c30l;
c40t = 407*8*4./c40l;
c50t = 407*8*4./c50l;



%print median
disp('broadcast, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(b20l),median(b30l),median(b40l),median(b50l));
disp('Sequential, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(s20l),median(s30l),median(s40l),median(s50l));
disp('SecuCode, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(c20l),median(c30l),median(c40l),median(c50l));

disp('broadcast, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(b20t),median(b30t),median(b40t),median(b50t));
disp('Sequential, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(s20t),median(s30t),median(s40t),median(s50t));
disp('SecuCode, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(c20t),median(c30t),median(c40t),median(c50t));


bl= [mean(b20l) mean(b30l) mean(b40l) ];
berrl = [std(b20l) std(b30l) std(b40l) ];
sl = [mean(s20l) mean(s30l) mean(s40l) ];
serrl = [std(s20l) std(s30l) std(s40l) ];
cl = [mean(c20l) mean(c30l) mean(c40l) ];
cerrl = [std(c20l) std(c30l) std(c40l) ];

bt= [mean(b20t); mean(b30t); mean(b40t)];
berrt = [std(b20t); std(b30t); std(b40t)];
st = [mean(s20t); mean(s30t); mean(s40t)];
serrt = [std(s20t); std(s30t); std(s40t)];
ct = [mean(c20t); mean(c30t); mean(c40t)];
cerrt = [std(c20t); std(c30t); std(c40t)];


figure(1);
subplot(2,1,1);
errorbar(bl,berrl,'b-x');
hold on;
errorbar(sl,serrl,'g--o');
hold on;
errorbar(cl,cerrl,'r-o');
ylim([0,50]);
xlim([0.5,3.5]);
xticks([1,2,3]);
xticklabels({'20','30','40'});
ylabel('Latency (s)');
xlabel('Distance (cm)');
set(gca,'FontSize',18) % Creates an axes and sets its FontSize to 18
legend({'Wisecr','Wisecr(Seq)','SecuCode(FixKey)'},'Location','northwest','Orientation','horizontal','FontSize',14);

subplot(2,1,2);

hb = bar([bt st ct]);
set(hb(1), 'FaceColor','b')
set(hb(2), 'FaceColor','g')
set(hb(3), 'FaceColor','r')
hold on;
errorbar(bt,berrt,'k.');
errorbar(st,serrt,'k.');
errorbar(ct,cerrt,'k.');
xlim([0.5,3.5]);
ylim([0,2000]);
xticks([1,2,3]);
xticklabels({'20','30','40'});
ylabel('Throughput (bps)');
xlabel('Distance (cm)');

set(gca,'FontSize',18) % Creates an axes and sets its FontSize to 18
legend({'Wisecr','Wisecr(Seq)','SecuCode(FixKey)'},'Location','northwest','Orientation','horizontal','FontSize',14);


