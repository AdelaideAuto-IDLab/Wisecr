clear all;
close all;
clc;

b20l = [8.7441589
9.793349
9.2923281
8.5090338
8.7922055
10.3706344
10.4802549
8.3200743
7.7667606
9.73381
7.0638739
9.2077505
8.784122
8.7091831
9.3347817
8.8051001
9.1228027
8.766952
8.2839695
17.6312904
9.7425226
9.8968413
9.2358076
9.2876062
9.5740847
8.0962196
8.0071209
8.5453309
8.7503694
9.8909102
8.859844
7.9267559
9.5906376
9.1768871
7.7508375
10.8790642
9.1345706
8.7540149
8.6133729
15.200472
20.3585041
17.0035046
9.7764118
8.3885851
9.1116411
15.4752986
7.8014866
9.5380568
8.0509052
10.3815264
10.0654136
9.8818169
9.1395497
7.8960294
8.8662437
7.782818
7.7917637
8.4903376
8.853184
9.6467122
8.7434933
8.8442757
9.7628371
8.1683613
9.5943955
8.8603904
8.3397027
8.9392537
8.4415067
9.863103
8.874463
10.1517826
13.2308728
8.309601
8.7241603
9.4743719
8.7979327
8.0393223
9.1557566
9.1518335
8.0707178
7.6097269
7.5822232
9.1015057
8.4554611
9.3773189
10.0806798
8.1693419
7.9886821
8.7161947
9.5797387
8.9447532
8.6275205
10.6123481
9.2240534
9.5278532
14.1585934
7.201174
8.4670754
8.4633126
];
b30l = [11.0815303
11.416812
11.2855496
11.3288922
9.9586305
11.4536971
10.0591305
10.3119743
10.9610156
11.9183274
11.6245814
11.0467675
16.7593121
12.6136303
16.0031684
12.3766212
12.2553568
10.3188959
14.260836
12.1292661
11.9224683
10.1294169
12.5703091
14.2712737
11.1511234
15.5584217
11.315341
17.5116724
11.0499041
11.2464063
9.7165167
13.3965719
10.5958008
10.9026067
11.0289584
10.8477903
14.2870141
9.89063
10.7200985
11.0141454
11.0220867
11.777241
12.173613
9.886693
11.2937649
12.7205334
11.7106723
8.9489726
9.8214704
9.4979367
11.3156512
11.0574164
27.5294249
14.1489679
21.9174831
13.7235811
12.1382653
13.813297
14.4848127
14.0020035
10.6873887
11.6406262
13.8900344
10.7262085
13.0148115
12.8669187
26.7170148
18.9509172
23.6095258
14.1761009
12.6863427
13.2222265
11.3471775
12.9420392
26.160765
13.9224177
10.2420163
19.4038517
11.1936662
19.6161156
12.0432864
11.9710387
23.7676307
10.6914623
12.4223078
13.1625756
9.1389456
11.731231
13.2628984
10.79432
30.2910462
11.5597306
12.3214574
9.1897489
13.1856233
12.4531169
13.2359116
11.0392141
11.4054837
12.0714004
];
b40l = [29.5066196
29.3314153
56.5349739
31.2051751
28.273466
39.7785654
36.7559682
36.6359924
42.4702415
38.3546126
47.0424284
10.3012589
10.3788447
8.9838555
9.3047924
8.8829792
14.1416173
14.087634
20.6928462
13.8744468
11.2369706
23.6005689
9.5721205
7.8674826
10.4653219
8.9370834
25.284748
11.5765161
10.5273935
15.2716909
22.9214009
16.1183336
8.4826077
11.8666462
9.8073994
9.3028445
8.076043
22.4808693
10.5852554
10.8763999
15.2888564
10.5264336
8.7398791
13.9643765
8.9038562
9.8753398
9.4528461
15.2384313
11.4159376
12.7605146
10.1299191
10.8495035
16.8416947
10.1237692
10.7591475
10.7327658
9.3781096
16.4964837
15.9233513
9.3027499
9.0380305
8.6621509
9.3204675
13.5072465
9.3017371
14.1924615
15.8178235
17.559702
10.0148001
14.4499541
9.8263414
10.1711895
10.1878399
9.574155
13.9814691
10.2414654
9.7355776
15.4190071
9.4950549
11.2668723
10.7694885
14.3811377
10.1528202
9.8987894
14.4045125
20.5793648
10.6274793
12.3908772
10.6889825
15.9944258
10.1140148
8.5568159
8.7712578
21.9979286
10.746846
9.6014533
28.8064593
10.2510388
9.7989373
12.2470896
10.1111109
15.3262405
];
b50l = [0];

s20l = [23.9635574
20.7031818
22.4968518
19.6954071
21.3423906
28.5519413
20.964559
19.3886385
19.8382107
21.2200789
23.4296623
21.6429174
20.2145803
19.9463163
21.5938047
20.9659538
19.5240515
21.1905362
21.4448553
19.4583333
22.3823709
18.7296238
24.2988155
21.7374663
22.0520804
20.0602
20.2391432
20.9857094
21.8493273
21.7931679
21.567421
21.308832
20.7809367
22.3221145
24.2878705
23.5254069
22.9697417
20.781185
20.0018883
22.1841001
19.5941932
22.8059295
20.9873265
23.3725681
23.8271592
20.8015003
20.0850932
18.8733446
23.1276519
19.6834765
19.5318192
25.6091372
21.3541996
22.7447577
19.9176927
20.7188202
20.4244147
24.2092063
21.330902
21.6064717
20.3591886
22.2943798
24.7608755
21.6566325
18.8726319
22.0007655
21.820734
22.0717424
19.9970644
20.0104816
19.6799537
21.917383
20.4556286
19.8542964
21.8400912
18.9390566
20.4289542
23.7033373
20.8000172
19.6142081
20.0765324
20.903835
19.5445463
20.8435255
23.4161831
19.9113663
21.4983185
19.5168148
22.9971495
21.6471644
20.0844459
18.9989076
20.2222974
21.2750374
20.4838467
23.3379619
20.1094658
23.4691502
22.9665775
21.4294621
];
s30l = [85.3135474
48.0185683
73.1399888
88.2415278
272.4277595
96.0779755
104.1969646
52.6152663
71.6610589
132.9237364
53.5673557
76.0511267
82.5364652
79.7859146
58.2114141
62.7850513
130.3347168
21.1905658
30.9834235
19.2691541
22.2000644
20.8844874
21.4546938
21.5153869
23.404601
21.5227748
22.7575347
24.6640034
21.93476
21.3397865
23.6356654
22.2247264
26.4285932
22.9813649
20.7639157
24.6794641
23.2531166
23.0773496
23.9407149
26.2697528
21.7511509
23.2681724
23.0164631
24.837788
23.1810246
24.6706188
23.7457174
23.4243116
22.3729861
29.4133665
24.6722304
22.2519777
23.4247287
23.9563251
20.8846631
21.5556663
21.6092357
25.7249158
20.7932758
21.7182261
22.6179023
23.5621697
21.8573733
21.4135279
22.6742678
21.1440376
22.0168935
20.3827844
21.0248338
18.0873051
26.9224033
20.8290386
24.6724637
22.9483632
21.3890139
22.0237531
20.7316364
22.9125228
21.7443874
24.9759185
30.9034683
23.8948426
28.2709016
22.52225
19.5920284
22.022965
21.4708999
22.3545581
23.0875823
23.5016351
21.7347775
24.521707
21.292129
23.8683257
27.8445838
22.8326794
];
s40l = [44.8538248
41.2479754
38.6199714
47.9129574
39.7850609
38.8761772
43.3307463
47.1181478
41.9332498
42.285904
36.3729286
40.7185629
38.5791121
38.1211681
37.0955021
39.8220941
47.0196441
40.3579678
38.5617956
42.3878501
35.5583267
35.3794648
37.3412385
41.9116138
45.1090035
40.5201668
38.1562437
42.7817479
48.4537147
39.5400144
37.0552446
37.8715349
35.3770511
41.2877506
46.0690238
37.3263731
40.4329721
44.0690096
60.5393061
53.0400933
54.6557617
35.2050339
46.8950247
59.0154507
47.4321016
53.1723784
41.1944747
48.5336672
44.251965
48.0173539
38.3655764
50.915326
50.1258494
49.9625043
52.1570976
67.3066795
50.4623507
46.4831377
40.7073497
44.2261327
47.2654453
38.5708596
46.1341253
41.098557
52.7557493
49.4861207
45.6876617
65.3744585
47.9003419
57.7696061
52.8271222
49.7833097
44.6909636
48.5062879
42.5856469
46.2913035
39.0632881
50.8540172
48.3788994
47.252458
44.5405595
56.7526115
49.6583231
43.05866
40.5608804
39.2947656
45.9158706
47.2840047
53.2618488
42.7753603
49.8586963
68.9388549
42.7518545
47.1536675
41.0299194
49.8177969
45.807897
56.2785771
42.0302138
40.3573847
];
s50l = [0];

c20l = [17.3370243
21.5343841
18.7672221
20.3996932
22.0647351
18.0140322
17.6017833
18.0971842
19.6818484
22.7430921
21.3145005
19.4980047
20.2997498
19.5599189
21.1921724
18.5461597
18.4419829
21.632327
24.2895431
21.6602958
20.9362744
18.8305766
19.6430667
19.18052
18.7032521
22.3259473
20.6249407
22.0751318
19.3051175
18.0433175
22.2205262
18.5353734
20.2029085
15.8151438
17.4606014
21.8388347
18.4916031
20.1380097
26.0860237
18.8793944
18.9571877
23.5724448
19.2867176
17.7641961
19.2904886
20.3723649
20.0158831
17.570946
11.9287867
17.421895
23.5894046
17.681864
19.5692596
18.8306656
20.0935847
17.209537
18.4503419
21.4119878
19.5012905
19.1494152
20.3953661
19.9477389
18.1933721
20.1297296
19.8298051
18.6750003
24.0248387
20.7216843
17.3107642
17.2473635
19.572198
22.4912995
21.423719
21.7248361
17.4500105
18.087562
20.6526943
21.5360024
20.8328882
20.5472082
19.0152613
16.8863931
18.4903007
20.7088496
18.5137456
21.0191516
18.8690552
23.4092568
19.3368496
17.9098534
18.6616768
20.3060484
20.248019
20.0033292
19.0855006
18.1689062
17.4176725
18.8763795
19.7322054
20.7239544
];
c30l = [13.8422112
13.3822993
13.7594008
13.0300795
14.1025219
13.873808
13.1778764
12.4311767
13.3295725
12.8492793
13.0399959
13.1466849
12.449219
13.2499877
12.6200593
13.1562366
12.4036405
13.1359043
13.1614626
13.8571882
13.2000399
12.7492966
12.1700041
13.2227092
13.0785593
13.7835338
13.9005384
12.4474549
13.2334191
13.3329513
13.4084096
13.0717701
13.1287025
13.3276522
13.2317465
14.0341108
13.5329353
12.3173665
13.2022546
12.8556103
12.7308921
12.9129916
13.3373887
13.7504961
13.0286664
13.4025081
13.3211194
12.5924726
8.4437529
13.9741823
12.6118201
12.9898695
12.6341688
11.9908559
13.1491451
22.8151758
14.1879211
13.0686619
13.0509211
14.564374
14.0502864
12.4628544
13.0312549
12.9886715
12.7109224
15.4546241
13.6711591
13.7087238
13.7513109
13.7957015
13.004347
13.5897675
13.1344006
13.0300814
12.8969443
13.0562421
13.6966178
13.7229499
13.1024279
14.2595454
13.6647472
12.692445
12.9672219
13.4559697
13.5160783
13.544619
12.739105
9.5544994
13.764118
13.7562128
12.6586474
13.3625851
13.0338788
12.2426921
13.1100365
12.0272573
14.2483869
13.3492869
12.9908347
13.0345865
];
c40l = [13.9492903
13.3541878
14.4473813
14.0872696
14.5927602
14.4774498
14.3300408
14.6319735
14.1664008
8.5854962
14.4074311
15.4447593
14.4736649
13.581395
13.8111319
14.00825
14.5630342
14.5945249
14.7618956
15.072899
14.2705867
13.937008
13.6029816
13.6863226
15.7814223
15.572879
13.4626524
14.3425053
13.629593
14.1402084
14.4903086
15.0385398
15.1655852
14.5057747
14.609242
15.2867447
14.0795361
14.3702825
5.567641
14.9302537
15.3174866
14.355682
14.7107991
13.9214716
15.5495761
13.8202192
14.0013291
16.1498867
16.0843802
14.830738
13.9777612
13.3281173
13.8762313
14.1946583
14.5769097
13.9157812
14.4709534
14.0800428
15.0207911
7.5231095
14.2813046
14.3683841
13.9446699
13.1839194
6.496466
14.9691
6.6889564
7.4495675
15.9282306
13.2803672
14.4338453
14.3459444
13.2510546
14.3520275
14.5699
13.3423002
14.0997924
14.3032252
13.9824889
14.1886725
16.2862324
13.7959089
13.5502064
14.3044156
14.3922857
13.8165469
13.8634675
14.0808737
6.6414458
14.4046382
13.6657687
14.878118
13.8664907
13.4090507
];
c50l = [0];

b20t = 407*8*4./b20l;
b30t = 407*8*4./b30l;
b40t = 407*8*4./b40l;
b50t = 407*8*4./b50l;

s20t = 407*8*4./s20l;
s30t = 407*8*4./s30l;
s40t = 407*8*4./s40l;
s50t = 407*8*4./s50l;

c20t = 407*8*4./c20l;
c30t = 407*8*4./c30l;
c40t = 407*8*4./c40l;
c50t = 407*8*4./c50l;






bl= [mean(b20l) mean(b30l) mean(b40l) mean(b50l)];
berrl = [std(b20l) std(b30l) std(b40l) std(b40l)];
sl = [mean(s20l) mean(s30l) mean(s40l) mean(s50l)];
serrl = [std(s20l) std(s30l) std(s40l) std(s50l)];
cl = [mean(c20l) mean(c30l) mean(c40l) mean(c50l)];
cerrl = [std(c20l) std(c30l) std(c40l) std(c50l)];

bt= [mean(b20t); mean(b30t); mean(b40t); mean(b50t)];
berrt = [std(b20t); std(b30t); std(b40t); std(b40t)];
st = [mean(s20t); mean(s30t); mean(s40t); mean(s50t)];
serrt = [std(s20t); std(s30t); std(s40t); std(s50t)];
ct = [mean(c20t); mean(c30t); mean(c40t); mean(c50t)];
cerrt = [std(c20t); std(c30t); std(c40t); std(c50t)];


figure(1);
subplot(2,1,1);
errorbar(bl,berrl,'b-x');
hold on;
errorbar(sl,serrl,'g--o');
hold on;
errorbar(cl,cerrl,'r-o');
ylim([0,100]);
xlim([0.5,4.5]);
xticks([1,2,3,4]);
xticklabels({'20','30','40','50'});
ylabel('Latency (s)');
xlabel('Distance (cm)');
set(gca,'FontSize',18) % Creates an axes and sets its FontSize to 18
legend({'Wisecr','Wisecr(Seq)','SecuCode'},'Location','northwest','Orientation','horizontal','FontSize',14);

subplot(2,1,2);

hb = bar([bt st ct]);
set(hb(1), 'FaceColor','b')
set(hb(2), 'FaceColor','g')
set(hb(3), 'FaceColor','r')
hold on;
errorbar(bt,berrt,'k.');
errorbar(st,serrt,'k.');
errorbar(ct,cerrt,'k.');
xlim([0.5,4.5]);
xticks([1,2,3,4]);
xticklabels({'20','30','40','50'});
ylabel('Throughput (bps)');
xlabel('Distance (cm)');

set(gca,'FontSize',18) % Creates an axes and sets its FontSize to 18
legend({'Wisecr','Wisecr(Seq)','SecuCode'},'Location','northwest','Orientation','horizontal','FontSize',14);


