clear all;
close all;
clc;

Include_stork = true;

b20l = [8.20657
8.062127
8.5361635
8.0944857
7.9093495
8.4903285
8.7842716
7.3779047
8.4707737
7.6374822
7.9499822
8.0958657
8.0566142
12.4144376
7.7187397
8.4340502
7.900683
7.4654576
7.671518
7.4558433
8.0686505
7.904744
7.9768139
8.2015564
8.4090976
7.4894428
7.7077076
8.2000894
8.0504565
7.6667822
7.7427147
8.2196837
8.0186627
7.6403978
7.7165944
10.2415974
7.5371232
8.3063737
7.5264154
8.2950157
8.1525385
8.061198
8.6042576
8.0162802
15.0558789
7.6577335
7.5532819
7.7044718
7.6633302
7.6465657
7.6074362
7.9044332
7.4722642
7.9598613
7.0644678
8.4011259
8.1939986
8.2209536
8.0384091
7.6578189
7.4851014
7.1786393
8.4915568
7.5107398
8.1759605
7.3362485
7.6904682
7.463388
7.2796117
7.4709195
9.3133931
7.927778
7.7113746
7.731095
16.4612528
7.1818431
7.166863
7.6769815
7.4611208
8.0717866
7.2820743
7.5982024
7.5856931
7.8983834
7.4966364
8.4254026
8.086612
7.8420025
12.1833583
8.3182424
8.6922858
8.0544047
7.8737874
7.4528969
7.5532494
7.7724417
7.7532519
8.0067213
16.0681639
];
b30l = [8.8571015
8.4153374
7.9726405
9.095008
9.210835
9.6224129
8.4055226
10.2671132
9.843992
8.4102274
8.9315828
8.7559833
9.6762836
7.9171634
9.2554875
10.7936304
9.495178
8.2859214
8.0973694
8.4438818
7.9557032
9.7604223
8.8832113
7.851121
8.2315307
9.3335994
8.1433082
8.5529492
9.6483235
8.1750379
7.958903
9.9723413
8.4880386
9.0810125
8.5471605
8.0964158
8.6314723
7.7714233
8.2280984
13.5447376
9.9654421
7.3493504
8.7228333
10.35175
10.0015204
10.0687232
9.8052291
8.2347622
9.8670061
7.2375438
9.0264512
8.2327931
15.7889715
8.3780895
8.0512275
8.3826222
11.703748
7.6068065
8.8584479
9.8353272
8.390208
8.1960725
9.7473858
9.9357434
8.5432042
9.7964964
9.7601003
8.2266092
7.9399057
8.4362552
8.2090162
9.6922082
10.0992921
8.0101663
8.2954312
7.5504518
10.1979522
9.8439893
9.226578
8.8339697
8.1783993
9.9005958
10.0609244
8.342322
15.7387816
9.2556847
10.6573164
8.484766
8.670717
17.5125541
8.6143516
9.8373446
9.8318072
8.7194118
8.3813575
15.0144016
9.4408358
8.1733575
9.1834354
];
b40l = [17.1353672
21.2803357
19.0802145
20.1584375
9.6081473
12.0708867
10.9236809
50.0595595
27.262185
15.4577542
12.7530246
11.9607534
13.7765964
9.0927385
10.9088346
25.7940326
14.3833485
15.377218
9.7148978
16.2755242
12.6988266
24.6798583
12.6124054
15.4043609
8.7530442
22.5895669
18.2210353
11.918293
14.2516309
16.3129991
12.0060705
12.5347482
13.5714956
24.4803587
10.6273929
15.2715967
18.0019141
10.1755452
13.9768551
9.6197214
12.71634
13.6609298
10.8980897
9.9640634
17.5505143
17.4592718
12.2084907
12.3951808
10.656259
9.2068074
13.9638295
8.330717
14.0766971
13.9295964
18.4508525
13.4760766
12.326686
25.7104794
9.0588215
10.293102
13.6402927
11.5381799
14.2287646
15.2972794
17.9861743
12.498217
11.1486029
9.5366318
16.1411293
13.7046261
11.954368
10.9486581
12.5331163
10.7930142
10.2051513
10.6791905
10.0314867
12.7816309
22.6182622
10.0025626
15.9731245
20.1032249
11.104067
28.1766779
10.4487087
12.8996283
10.8664457
9.0413048
10.1061172
14.0706382
19.9412613
11.7929823
];
b50l = [0];

s20l = [21.3743515
19.328067
20.2095382
19.6507582
18.8389867
24.4321576
20.4310481
18.8437446
16.1897174
18.0919713
18.6848626
21.5130781
21.3018814
18.2389734
17.3484503
17.8699309
19.3018443
18.9001659
17.6656996
18.6424831
18.3908173
16.3274114
19.5476415
16.9292263
17.4862447
17.2871272
16.8908947
18.0369854
18.0975676
18.4460008
16.7185876
17.7267194
17.4984385
17.1983456
15.8785897
19.3450868
15.9862892
20.9073677
18.0029603
18.9490365
17.0748539
18.6649198
22.8347979
18.8254737
18.4134751
18.1563255
20.2471683
19.3074591
20.5002906
18.3334968
17.0976716
17.4838905
18.2101975
17.7546626
19.0383714
18.1390704
18.598358
16.3764882
18.5399905
22.4921118
18.8155688
20.6214444
18.159955
19.123897
18.4426034
18.5932876
18.8809806
16.6504165
17.7483916
17.3959086
18.5011748
19.0443154
21.0059948
19.6674549
20.4787036
17.604842
19.0528837
19.2167655
19.495476
17.822644
17.3746565
18.558503
18.8432223
16.8234741
17.1781274
17.3984867
19.0916432
18.0069009
19.5945148
16.9882415
18.1642418
18.8906474
17.4838894
15.5831396
17.0685118
18.1905528
19.2470469
17.9610467
18.1213593
17.264548
];
s30l = [19.9953854
20.7736897
18.9541997
21.1533206
19.9057144
18.4113067
18.6567104
19.4981583
19.4178169
18.4569618
18.8293416
18.3037917
24.3405866
17.9882231
18.3155404
16.9716671
20.9488366
18.9269418
19.0099809
20.3152217
25.3309662
18.7539916
25.8958662
20.5237218
20.8756275
23.5753066
20.9825099
18.9394993
17.4697291
18.4957302
17.3040634
21.2103134
20.1422147
19.5809283
18.5106507
20.842581
20.0299527
21.1809786
20.3129683
24.2682903
20.7810811
21.6888737
20.0957349
20.1019304
22.2111296
22.0491538
20.2723348
19.9875868
23.4007957
18.7095413
20.746614
18.242287
18.6245091
19.8140638
19.0525245
19.9291502
16.1954905
18.1015689
20.205257
22.1515367
18.6650531
21.4352618
17.8065962
18.2308564
19.2818277
23.5022565
20.1667034
23.115713
22.1871636
23.4364547
21.4433835
20.4549298
18.4905733
24.1280115
20.6955553
25.4565612
19.079887
17.8572041
17.8054956
18.0077033
18.2861663
22.8409125
17.7894362
20.7568775
19.7147292
18.9831675
16.9643529
16.8233177
22.2464409
18.5174458
22.2916794
21.4921484
19.1913456
20.2199478
24.9810994
22.5226998
18.7423869
20.7828832
24.8017362
20.4002272
];
s40l = [26.8158197
19.6694222
22.9032251
24.4192732
26.1118146
20.944397
22.0753294
19.5617783
20.5923335
46.5290874
22.3375752
22.4520281
34.6411071
26.7858227
27.1104309
31.28242
24.6109128
26.1436982
26.5244889
32.0267326
21.1889844
19.7155806
35.5850179
24.2080923
19.6852776
29.1301377
27.5795581
28.3825128
20.4726728
22.2049717
32.1736621
27.1355934
23.0465201
25.0521006
28.0712925
22.4532968
28.612256
21.8790319
34.1280243
23.5934021
21.7172038
20.848201
18.8076449
23.3737713
24.3366502
32.4015988
21.56841
20.8026071
21.8796998
22.4470237
30.6715752
20.5557611
22.3016395
20.3689352
21.5145318
23.3594486
30.4592323
21.3157082
21.138859
23.324636
22.7364307
34.8356575
26.4173588
20.1992192
42.0439501
22.3977146
26.0930991
32.5765985
40.8353021
28.7371448
34.4693838
25.2558221
21.9592784
27.5849222
33.3220763
21.4078249
29.9668155
24.8816749
22.8655802
31.6333526
27.4089599
27.3125808
26.574396
28.1445246
34.9351588
26.1504814
28.3714777
24.5188426
33.2571616
55.320797
23.0423009
27.6993461
32.9903346
27.4899864
19.0088716
29.7942842
54.388505
22.619729
32.9418419
];
s50l = [0];

c20l = [13.7691637
13.9581576
15.1660457
13.7646133
14.6546106
14.3380472
14.2620392
13.72138
14.6049565
15.3418441
13.6047099
14.3068879
13.3412872
14.7139527
14.386621
13.3806899
13.0539196
13.7677477
15.1243795
14.6624411
13.6421156
14.5471499
14.1741612
12.719785
14.9664876
13.8441466
13.366079
14.4176395
13.5307618
14.1665247
13.0311334
14.4743519
14.2572284
14.6156927
13.0610495
14.2920701
14.3131306
14.0358867
13.4670137
13.5524486
14.1834095
13.7404289
14.5485583
13.5547838
12.7967527
14.8035907
14.3018985
14.1581656
13.9768314
13.8744072
13.3387873
14.3612131
13.4834668
12.5622991
14.2130611
14.7850962
14.3031982
13.8011215
14.2254628
14.4031674
15.0586893
14.3655479
13.1605919
13.783395
13.8222066
13.3816797
13.7569694
13.7322773
14.3538984
14.4682555
13.9716718
14.7338212
14.0755532
14.0812844
14.8094064
12.7919074
13.1822418
14.5230721
12.6186596
14.8775594
14.6314455
14.6976825
13.8869537
13.9421272
13.7581173
14.2791698
15.3862785
14.3720949
13.720585
13.8855551
13.7745203
14.2548193
14.6824297
14.0998208
13.3589657
13.9350673
14.6810693
];
c30l = [13.7364867
12.8653115
13.8397171
13.1735275
12.6914291
13.4854242
13.3711042
13.0254738
12.993083
13.3498595
14.5867301
13.7903719
13.0323598
13.5806926
13.4389676
13.652185
13.8935887
13.9154552
12.5798131
13.407514
13.2918282
13.3371032
13.9633492
13.3181894
13.6621431
12.9399507
13.249321
13.2446054
13.5571705
13.7855694
12.5867581
13.5683704
14.3852864
13.4312952
13.2899428
13.9392781
13.3907356
13.7790463
13.1039597
14.1619509
12.5045698
12.7202838
14.452336
13.8587483
14.1370287
13.3061756
12.4908125
14.7509094
13.596778
13.0104315
13.0146169
12.9135957
13.9054993
13.5852901
14.6989097
13.283677
13.0848113
14.1241395
14.0450496
13.2700459
13.2918476
12.9636131
13.9878686
13.8407122
14.1819652
13.3318059
13.425988
13.9599146
13.584065
13.1484721
12.521855
12.7339003
14.605531
13.8703791
12.4852649
14.0373964
14.1618755
13.1801479
13.8171112
13.6475937
13.0327655
13.6180665
12.7133094
13.0854162
13.722302
13.1843498
14.1340478
13.5720368
13.27509
12.6552789
12.6126112
13.691016
13.1045803
12.971856
13.3467206
13.1578372
13.5472887
12.9408126
12.809356
];
c40l = [15.56348
15.7675234
13.4193862
16.0279976
15.164744
13.7770601
15.3298661
14.3850043
14.9249563
14.7494074
16.378267
14.1715381
15.4311028
15.8402221
15.3865454
14.9038184
14.1425209
15.898833
15.6943541
14.2140282
14.8547369
16.0202962
14.9490706
15.3110511
15.6801714
15.2115081
13.9382929
16.3900415
15.4687184
14.3983363
14.4202549
16.3151804
15.0613979
13.905548
15.2407759
16.032641
14.3359534
15.860404
14.8898801
14.8796075
16.7130088
16.7269384
15.8268984
14.5026035
15.4712468
14.7706417
15.8024701
15.2682146
14.4028276
14.4765874
18.2622372
15.44841
15.1405523
16.2759507
16.3484936
14.8167765
16.2633744
15.5892535
15.9156607
16.6013819
15.0978899
14.0802409
15.0233153
16.7433623
15.8859259
15.5942356
14.8940165
14.5214413
14.4710583
15.213312
16.15525
14.0598162
15.1976069
15.0271992
17.3729305
15.2081688
14.5677634
16.3301301
17.2977674
14.9861161
14.9574528
15.2122857
16.2958072
15.7980787
14.7751374
16.277441
14.5921291
15.0254939
13.9435363
15.1241393
14.3607293
15.2337546
14.6182029
15.3472574
15.5508859
];
c50l = [0];

Stork_20cm_l = [8.76400000000000;15.0560000000000;11.3210000000000;15.5840000000000;6.83900000000000;7.45100000000000;11.0740000000000;15.1360000000000;14.9530000000000;12.6730000000000;7.87800000000000;8.55200000000000;8.60100000000000;11.3910000000000;10.2920000000000;9.34600000000000;8.88900000000000;13.4500000000000;17.8570000000000;9.91800000000000;9.68600000000000;8.74000000000000;12.0230000000000;8.80300000000000;14.3810000000000;11.6810000000000;13.5600000000000;15.1460000000000;10.6890000000000;15.7230000000000;11.2900000000000;9.90300000000000;9.88200000000000;13.3920000000000;10.2300000000000;11.1300000000000;11.3770000000000;15.0030000000000;8.70900000000000;14.2510000000000;9.00900000000000;12.0300000000000;14.1020000000000;12.0570000000000;10.6720000000000;8.87100000000000;7.49800000000000;12.6760000000000;12.7780000000000;12.1680000000000;10.8640000000000;18.4740000000000;12.5260000000000;10.5910000000000;12.7270000000000;8.30600000000000;11.9000000000000;11.3930000000000;13.1420000000000;15.3430000000000;15.7130000000000;14.3230000000000;11.6530000000000;13.2470000000000;10.4540000000000;12.3020000000000;15.3500000000000;12.1530000000000;11.8340000000000;14.6040000000000;14.1620000000000;10.7260000000000;14.6610000000000;16.2190000000000;13.0350000000000;10.8680000000000;10.8040000000000;12.6840000000000;15.1160000000000;16.1730000000000;15.3560000000000;11.4910000000000;11.2950000000000;16.6230000000000;13.0240000000000;16.9620000000000;14.0870000000000;13.8810000000000;13.3890000000000;11.1870000000000;15.1570000000000;15.7520000000000;18.1360000000000;20.4690000000000;12.4190000000000;14.5160000000000;13.2980000000000;13.7750000000000;11.8870000000000;16.7280000000000];

Stork_30cm_l = [11.9710000000000;9.11400000000000;12.8160000000000;6.96000000000000;11.4490000000000;10.5730000000000;7.20400000000000;7.76200000000000;10.9300000000000;12.8710000000000;9.59800000000000;11.8870000000000;10.4590000000000;8.92700000000000;11.7080000000000;9.38700000000000;13.1200000000000;10.6050000000000;11.5010000000000;11.3570000000000;18.7150000000000;10.7500000000000;10.2870000000000;13.9200000000000;13.1330000000000;11.0730000000000;9.80400000000000;11.6510000000000;14.3340000000000;15.1220000000000;23.4520000000000;13.5380000000000;17.6170000000000;11.7520000000000;11.3650000000000;10.6920000000000;17.4160000000000;14.4270000000000;14.1700000000000;11.9170000000000;15.9050000000000;15.2850000000000;12.3300000000000;9.11000000000000;13.0080000000000;11.3050000000000;14.3030000000000;8.83700000000000;23.5140000000000;10.9370000000000;16.0590000000000;9.75500000000000;14.8710000000000;17.2530000000000;14.8820000000000;17.9400000000000;13.2500000000000;20.8850000000000;12.9370000000000;17.6720000000000;14.8800000000000;17.6910000000000;14.0410000000000;13.1500000000000;11.2810000000000;14.2220000000000;11.5920000000000;11.4910000000000;17.0040000000000;15.4200000000000;11.4010000000000;18.6300000000000;11.3960000000000;19.9490000000000;24.5100000000000;14.9270000000000;14.6480000000000;13.5620000000000;13.9100000000000;11.6820000000000;21.0260000000000;16.9380000000000;21.1030000000000;17.2240000000000;26.5240000000000;15.5530000000000;19.9590000000000;13.7040000000000;20.2550000000000;15.7410000000000;17.6430000000000;17.4170000000000;13.3630000000000;16.0850000000000;16.7730000000000;19.2670000000000;14.9520000000000;16.6530000000000;16.6720000000000;19.9260000000000];

Stork_40cm_l = [11.7980000000000;14.9870000000000;16.1890000000000;11.7900000000000;10.8590000000000;18.2830000000000;11.6250000000000;11.6220000000000;15.8900000000000;8.65600000000000;7.13500000000000;10.6180000000000;14.0940000000000;10.2300000000000;10.1500000000000;7.63800000000000;15.2510000000000;10.7940000000000;14.5670000000000;9.30900000000000;11.1980000000000;17.0070000000000;11.8560000000000;11.6020000000000;17.5840000000000;17.0140000000000;15.4910000000000;11.1820000000000;11.4850000000000;12.1860000000000;11.1510000000000;15.2550000000000;10.3100000000000;12.9620000000000;11.6420000000000;15.1950000000000;11.0960000000000;21.4870000000000;14.6840000000000;14.4280000000000;14.9060000000000;8.86300000000000;13.2020000000000;14;12.2530000000000;21.1140000000000;19.0780000000000;8.37100000000000;17.8740000000000;19.9950000000000;14.7810000000000;26.4990000000000;14.6980000000000;17.3860000000000;11.5690000000000;18.4760000000000;14.7570000000000;14.1900000000000;14.7940000000000;13.7760000000000;22.2080000000000;18.5940000000000;17.5420000000000;17.8990000000000;13.3400000000000;12.5560000000000;12.4210000000000;13.9860000000000;13.5780000000000;17.4420000000000;13.1090000000000;20.3460000000000;13.2560000000000;16.1340000000000;16.7270000000000;17.3570000000000;14.8100000000000;13.3360000000000;19.8410000000000;13.6320000000000;23.4590000000000;21.1600000000000;15.6600000000000;19.5440000000000;14.9600000000000;18.2620000000000;15.4310000000000;17.3630000000000;16.0910000000000;18.8440000000000;17.5540000000000;16.2430000000000;21.0270000000000;21.5010000000000;22.1070000000000;15.6030000000000;31.1720000000000;19.4650000000000;19.1850000000000;19.7400000000000];

Stork_50cm_l = [7.96
10.778
9.123
7.67
7.965
7.964
7.116
9.038
11.25
13.97
13.061
11.698
8.891
13.632
10.571
7.424
7.474
11.716
22.086
15.531
12.196
12.501
13.413
12.558
9.761
8.454
17.445
15.801
11.786
17.815
13.544
9.252
13.691
9.582
19.69
17.09
15.064
10.217
10.398
14.977
17.483
11.965
14.942
14.758
11.148
20.971
14.74
10.172
14.537
12.031
11.575
17.892
13.59
12.431
16.973
11.111
13.435
12.884
14.92
11.508
9.141
16.162
17.973
19.035
15.588
14.207
14.923
12.473
16.674
17.452
12.781
13.028
11.933
20.859
13.117
14.776
12.546
13.464
21.203
15.638
12.053
16.621
19.413
17.211
16.29
12.859
21.318
15.634
14.609
11.711
15.586
17.349
14.635
16.359
18.535
21.34
22.279
24.422
22.961
15.38
];

% remove outliers
b20l = rmoutliers(b20l,'quartiles');
b30l = rmoutliers(b30l,'quartiles');
b40l = rmoutliers(b40l,'quartiles');
b50l = rmoutliers(b50l,'quartiles');
s20l = rmoutliers(s20l,'quartiles');
s30l = rmoutliers(s30l,'quartiles');
s40l = rmoutliers(s40l,'quartiles');
s50l = rmoutliers(s50l,'quartiles');
c20l = rmoutliers(c20l,'quartiles');
c30l = rmoutliers(c30l,'quartiles');
c40l = rmoutliers(c40l,'quartiles');
c50l = rmoutliers(c50l,'quartiles');

st20l = rmoutliers(Stork_20cm_l,'quartiles');
st30l = rmoutliers(Stork_30cm_l,'quartiles');
st40l = rmoutliers(Stork_40cm_l,'quartiles');
st50l = rmoutliers(Stork_50cm_l,'quartiles');

b20t = 407*8*4./b20l;
b30t = 407*8*4./b30l;
b40t = 407*8*4./b40l;
b50t = 407*8*4./b50l;

s20t = 407*8*4./s20l;
s30t = 407*8*4./s30l;
s40t = 407*8*4./s40l;
s50t = 407*8*4./s50l;

c20t = 407*8*4./c20l;
c30t = 407*8*4./c30l;
c40t = 407*8*4./c40l;
c50t = 407*8*4./c50l;

st20t = 407*8*4./st20l;
st30t = 407*8*4./st30l;
st40t = 407*8*4./st40l;
st50t = 407*8*4./st50l;



%print median
disp('broadcast, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(b20l),median(b30l),median(b40l),median(b50l));
disp('Sequential, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(s20l),median(s30l),median(s40l),median(s50l));
disp('SecuCode, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(c20l),median(c30l),median(c40l),median(c50l));
disp('Stork, median latency:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(st20l),median(st30l),median(st40l),median(st50l));

disp('broadcast, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(b20t),median(b30t),median(b40t),median(b50t));
disp('Sequential, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(s20t),median(s30t),median(s40t),median(s50t));
disp('SecuCode, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(c20t),median(c30t),median(c40t),median(c50t));
disp('Stork, median throughput:')
fprintf('%2.2f,%2.2f,%2.2f,%2.2f\n',median(st20t),median(st30t),median(st40t),median(st50t));


bl= [mean(b20l) mean(b30l) mean(b40l) ];
berrl = [std(b20l) std(b30l) std(b40l) ];
sl = [mean(s20l) mean(s30l) mean(s40l) ];
serrl = [std(s20l) std(s30l) std(s40l) ];
cl = [mean(c20l) mean(c30l) mean(c40l) ];
cerrl = [std(c20l) std(c30l) std(c40l) ];
stl = [mean(st20l) mean(st30l) mean(st40l) ];
sterrl = [std(st20l) std(st30l) std(st40l) ];

bt= [mean(b20t); mean(b30t); mean(b40t)]/1000;
berrt = [std(b20t); std(b30t); std(b40t)]/1000;
st = [mean(s20t); mean(s30t); mean(s40t)]/1000;
serrt = [std(s20t); std(s30t); std(s40t)]/1000;
ct = [mean(c20t); mean(c30t); mean(c40t)]/1000;
cerrt = [std(c20t); std(c30t); std(c40t)]/1000;
stt = [mean(st20t); mean(st30t); mean(st40t)]/1000;
sterrt = [std(st20t); std(st30t); std(st40t)]/1000;


figure(1);
subplot(2,3,1);
errorbar(bl,berrl,'b-x');
if(Include_stork)
    hold on;
    errorbar(stl,sterrl,'r-d');
else
    hold on;
    errorbar(sl,serrl,'g--s');
    hold on;
    errorbar(cl,cerrl,'r-o');
end
grid on;
ylim([0,30]);
xlim([0.5,3.5]);
xticks([1,2,3]);
yticks([0,15,30]);
% xticklabels({'20','30','40'});
xticklabels([]);
ylabel('Latency (s)');
% xlabel('Distance (cm)');
set(gca,'FontSize',18) % Creates an axes and sets its FontSize to 18
if(Include_stork)
    legend({'Wisecr','Stork'},'Location','northwest','Orientation','horizontal','FontSize',14);
else
    legend({'Wisecr','Wisecr(Seq)','SecuCode(FixKey)'},'Location','northwest','Orientation','horizontal','FontSize',14);
end
subplot(2,3,4);
if(Include_stork)
    hb = bar([bt stt]);
else
    hb = bar([bt st ct]);
end
set(hb(1), 'FaceColor','b')
if(Include_stork)
    set(hb(2), 'FaceColor','r')
else
    set(hb(2), 'FaceColor','g')
    set(hb(3), 'FaceColor','r')
end
hold on;
grid on;

% Get the x coordinate of the bars
x = [];
for i = 1:length(hb)
    x = [x ; hb(i).XEndPoints];
end

errorbar(x(1,:),bt,berrt,'k.');
if(Include_stork)
    errorbar(x(2,:),stt,sterrt,'k.');
else
    errorbar(x(2,:),st,serrt,'k.');
    errorbar(x(3,:),ct,cerrt,'k.');
end
xlim([0.5,3.5]);
ylim([0,2]);
xticks([1,2,3]);
xticklabels({'20','30','40'});
ylabel({'Throughput','(Kbps)'});
xlabel('Distance (cm)');

set(gca,'FontSize',18) % Creates an axes and sets its FontSize to 18
if(Include_stork)
    legend({'Wisecr','Stork'},'Location','northwest','Orientation','horizontal','FontSize',14);
else
    legend({'Wisecr','Wisecr(Seq)','SecuCode(FixKey)'},'Location','northwest','Orientation','horizontal','FontSize',14);
end


